{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/MOVIES/New%20folder/K/kimi/src/components/HomeClient.jsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect, useRef, useCallback, useLayoutEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { products } from '../data/products';\r\n// import '../pages/Home.css'; // Moved to layout.jsx\r\n\r\nconst HomeClient = () => {\r\n    const [displayProducts, setDisplayProducts] = useState([]);\r\n    const [showLoadPrevious, setShowLoadPrevious] = useState(false);\r\n\r\n    const masterListRef = useRef([]);\r\n    const visibleWindowRef = useRef({ start: 0, end: 0 });\r\n    const loadingRef = useRef(false);\r\n    const observerRef = useRef(null);\r\n    const loadingIndicatorRef = useRef(null);\r\n    const scrollPreserveRef = useRef({ isPrepending: false, previousHeight: 0 });\r\n\r\n    const BATCH_SIZE = 24;\r\n    const MAX_VISIBLE_ITEMS = 72;\r\n\r\n    const [hasMore, setHasMore] = useState(true);\r\n\r\n    const updateDisplay = () => {\r\n        const { start, end } = visibleWindowRef.current;\r\n        const slice = masterListRef.current.slice(start, end);\r\n        setDisplayProducts(slice);\r\n        setShowLoadPrevious(start > 0);\r\n        setHasMore(end < masterListRef.current.length);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!products || !Array.isArray(products)) return;\r\n\r\n        // Shuffle once on init\r\n        const shuffled = [...products].sort(() => 0.5 - Math.random());\r\n\r\n        // Add unique key just in case, but maintain 1-to-1 mapping\r\n        const prepareProducts = shuffled.map(p => ({\r\n            ...p,\r\n            uniqueKey: `${p.id}-${Date.now()}-${Math.random()}`\r\n        }));\r\n\r\n        masterListRef.current = prepareProducts;\r\n\r\n        // Initial window\r\n        const initialCount = Math.min(BATCH_SIZE, prepareProducts.length);\r\n        visibleWindowRef.current = { start: 0, end: initialCount };\r\n        updateDisplay();\r\n    }, []);\r\n\r\n    useLayoutEffect(() => {\r\n        if (scrollPreserveRef.current.isPrepending) {\r\n            const newHeight = document.documentElement.scrollHeight;\r\n            const diff = newHeight - scrollPreserveRef.current.previousHeight;\r\n            window.scrollBy(0, diff);\r\n            scrollPreserveRef.current.isPrepending = false;\r\n        }\r\n    }, [displayProducts]);\r\n\r\n    const loadMore = useCallback(() => {\r\n        if (loadingRef.current) return;\r\n\r\n        const totalItems = masterListRef.current.length;\r\n        const { end } = visibleWindowRef.current;\r\n\r\n        // Stop if we've shown all products\r\n        if (end >= totalItems) return;\r\n\r\n        loadingRef.current = true;\r\n\r\n        setTimeout(() => {\r\n            try {\r\n                let { start, currentEnd } = visibleWindowRef.current;\r\n\r\n                // Just extend the window, don't create new items\r\n                let newEnd = end + BATCH_SIZE;\r\n                if (newEnd > totalItems) newEnd = totalItems;\r\n\r\n                if (newEnd - start > MAX_VISIBLE_ITEMS) {\r\n                    start = newEnd - MAX_VISIBLE_ITEMS;\r\n                }\r\n\r\n                visibleWindowRef.current = { start, end: newEnd };\r\n                updateDisplay();\r\n            } catch (error) {\r\n                console.error(\"Error loading more products:\", error);\r\n            } finally {\r\n                loadingRef.current = false;\r\n            }\r\n        }, 500);\r\n    }, []);\r\n\r\n    const loadPrevious = () => {\r\n        scrollPreserveRef.current = {\r\n            isPrepending: true,\r\n            previousHeight: document.documentElement.scrollHeight\r\n        };\r\n\r\n        let { start, end } = visibleWindowRef.current;\r\n        const newStart = Math.max(0, start - BATCH_SIZE);\r\n\r\n        visibleWindowRef.current = { start: newStart, end };\r\n        updateDisplay();\r\n    };\r\n\r\n    useEffect(() => {\r\n        const options = {\r\n            root: null,\r\n            rootMargin: '100px',\r\n            threshold: 0.1\r\n        };\r\n\r\n        observerRef.current = new IntersectionObserver((entries) => {\r\n            const first = entries[0];\r\n            if (first.isIntersecting && hasMore) { // Only load more if hasMore is true\r\n                loadMore();\r\n            }\r\n        }, options);\r\n\r\n        if (loadingIndicatorRef.current && hasMore) { // Only observe if there's more to load\r\n            observerRef.current.observe(loadingIndicatorRef.current);\r\n        }\r\n\r\n        return () => {\r\n            if (observerRef.current) {\r\n                observerRef.current.disconnect();\r\n            }\r\n        };\r\n    }, [loadMore, hasMore]); // Add hasMore dependency to re-observe if it reappears\r\n\r\n    const mainCategories = [\r\n        { id: 'men', name: 'Men', image: 'https://i.postimg.cc/prXDrB2s/premium-grey-hoodie-atsu-wolf.webp', link: '/shop/Men' },\r\n        { id: 'women', name: 'Women', image: 'https://i.postimg.cc/g2YnW02T/Ghost-of-Yotei-Pink-Hoodie.webp', link: '/shop/Women' },\r\n        { id: 'kids', name: 'Kids', image: 'https://i.postimg.cc/prXDrB2s/premium-grey-hoodie-atsu-wolf.webp', link: '/shop/Kids' },\r\n        { id: 'hoodies', name: 'Hoodies', image: 'https://i.postimg.cc/g2YnW02T/Ghost-of-Yotei-Pink-Hoodie.webp', link: '/shop/Hoodies' },\r\n        { id: 'jackets', name: 'Jackets', image: 'https://i.postimg.cc/prXDrB2s/premium-grey-hoodie-atsu-wolf.webp', link: '/shop/Jackets' }\r\n    ];\r\n\r\n    const gamingCollections = [\r\n        { id: 'ghost-of-yotei', name: 'Ghost of Yotei', image: 'https://i.postimg.cc/prXDrB2s/premium-grey-hoodie-atsu-wolf.webp', link: '/shop/Gaming%20Outfits/Ghost%20of%20Yotei' }\r\n    ];\r\n\r\n    if (!products || !Array.isArray(products)) {\r\n        return <div className=\"container\" style={{ padding: '100px 0', textAlign: 'center' }}>Error loading products.</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"home-page\">\r\n            {/* Hero Section Restored */}\r\n            <section className=\"hero\">\r\n                <div className=\"hero-content fade-in-up\">\r\n                    <h1 className=\"h1 hero-title\">Wear Without Fear</h1>\r\n                    <p className=\"hero-subtitle\">Pakistan's premier fashion destination. Authentic style, tailored for you.</p>\r\n                    <div className=\"hero-actions\">\r\n                        <Link href=\"/collections\" className=\"btn btn-primary\">Shop Collection</Link>\r\n                        <button className=\"btn btn-outline\">View Lookbook</button>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Featured Products Section */}\r\n            <section className=\"section container\" style={{ marginTop: '4rem' }}>\r\n                <div className=\"section-header text-center mb-10\">\r\n                    <h2 className=\"h2 section-title\">Featured Products</h2>\r\n                    <div className=\"section-divider mx-auto\"></div>\r\n                    <p className=\"section-subtitle text-muted\">Premium quality, designed for the bold.</p>\r\n                </div>\r\n\r\n                {showLoadPrevious && (\r\n                    <div className=\"text-center mb-8\">\r\n                        <button onClick={loadPrevious} className=\"btn btn-outline load-prev-btn\">\r\n                            Load Previous Products\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"product-grid\">\r\n                    {displayProducts.map((product) => (\r\n                        <div key={product.uniqueKey} className=\"product-card fade-in\">\r\n                            <Link href={`/product/${product.slug}`} className=\"product-image-wrapper\">\r\n                                <img src={product.image} alt={product.name} className=\"product-image\" />\r\n                                <div className=\"product-overlay\">\r\n                                    <button className=\"btn btn-secondary quick-view-btn\">View Details</button>\r\n                                </div>\r\n                            </Link>\r\n                            <div className=\"product-info\">\r\n                                <span style={{ fontSize: '0.75rem', color: 'var(--color-text-light)', fontWeight: '500', marginBottom: '4px', display: 'block' }}>\r\n                                    ID: {product.id}\r\n                                </span>\r\n                                <Link href={`/product/${product.slug}`} className=\"product-title\">{product.name}</Link>\r\n                                <div className=\"product-meta\">\r\n                                    <span className=\"product-price\">PKR {product.price.toLocaleString()}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {hasMore && (\r\n                    <div className=\"loading-indicator\" ref={loadingIndicatorRef}>\r\n                        <div className=\"spinner\"></div>\r\n                        <p>Loading products...</p>\r\n                    </div>\r\n                )}\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HomeClient;\r\n"],"names":[],"mappings":"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"}}]
}